<ion-content>
  <ion-card class="form-box">
    <ion-card-header>
      <ion-card-title>Registrarse</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <form #registrationForm="ngForm" (ngSubmit)="register()">
        <ion-item>
          <ion-label position="stacked">Correo</ion-label>
          <ion-input type="email" [(ngModel)]="email" name="email" placeholder="Correo" required #emailInput="ngModel"></ion-input>
        </ion-item>
        <div *ngIf="emailInput.invalid && emailInput.touched" class="error-message">
          <small *ngIf="emailInput.errors?.['required']">El correo es obligatorio.</small>
          <small *ngIf="emailInput.errors?.['email']">El formato del correo no es válido.</small>
        </div>

        <ion-item>
          <ion-label position="stacked">Nombre</ion-label>
          <ion-input type="text" [(ngModel)]="name" name="name" placeholder="Nombre" required #nameInput="ngModel"></ion-input>
        </ion-item>
        <div *ngIf="nameInput.invalid && nameInput.touched" class="error-message">
          <small *ngIf="nameInput.errors?.['required']">El nombre es obligatorio.</small>
        </div>

        <ion-item>
          <ion-label position="stacked">Nombre de Usuario</ion-label>
          <ion-input type="text" [(ngModel)]="username" name="username" placeholder="Nombre de Usuario" required #usernameInput="ngModel"></ion-input>
        </ion-item>
        <div *ngIf="usernameInput.invalid && usernameInput.touched" class="error-message">
          <small *ngIf="usernameInput.errors?.['required']">El nombre de usuario es obligatorio.</small>
        </div>

        <ion-item>
          <ion-label position="stacked">Contraseña</ion-label>
          <ion-input type="password" [(ngModel)]="password" name="password" placeholder="Contraseña" required minlength="6" #passwordInput="ngModel"></ion-input>
        </ion-item>
        <div *ngIf="passwordInput.invalid && passwordInput.touched" class="error-message">
          <small *ngIf="passwordInput.errors?.['required']">La contraseña es obligatoria.</small>
          <small *ngIf="passwordInput.errors?.['minlength']">La contraseña debe tener al menos 6 caracteres.</small>
        </div>

        <ion-item lines="none">
          <ion-checkbox slot="start" [(ngModel)]="termsAccepted" name="termsAccepted" required></ion-checkbox>
          <ion-label>
            Acepto todos los 
            <span class="link" (click)="onPoliciesClick()">Términos de Servicio</span> y la 
            <span class="link" (click)="onPoliciesClick()">Política de Privacidad</span>.
          </ion-label>
        </ion-item>
        <div *ngIf="!termsAccepted && registrationForm.submitted" class="error-message">
          <small>Debes aceptar los términos y condiciones.</small>
        </div>

        <ion-button expand="block" type="submit" [disabled]="registrationForm.invalid">Registrarse</ion-button>
      </form>
      <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
      <div class="register-footer">
        <span class="bold-text">Si ya tienes cuenta</span>
        <a routerLink="/login"><ion-button fill="clear" class="shadow-text">Iniciar sesión</ion-button></a>
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>
